from math import gcd, lcm

from Crypto.Util.number import getStrongPrime


def main():
    e = 3

    p = getStrongPrime(1024, e=e)
    q = getStrongPrime(1024, e=e)
    n = p * q
    t = lcm(p - 1, q - 1)

    assert gcd(e, t) == 1

    d = pow(e, -1, t)

    with open("flag.txt", "rb") as f:
        pt = int.from_bytes(f.read(), "big")

    ct = pow(pt, e, n)

    print(f"e = {e}")  # e = 3
    print(f"n = {n}")  # n = 18248115999147265719349421179527162797840605606225773686639226953859804722611128825242080618926726843201681381270986490033713546540385935620777644008067956139564240175396786632962956407306722759881531973013236666663066968413291465989912464342508955934542193088197556069017512935579516565800490010094137287005005364485681933092283908475517565532954019833226027847120022026988980426591577686901443163546258962425063858076927230532351168390553994739080544956733941486812192582024673246545482063097059371973636592511833796921031720161160900462744206059004583431163590820221154150832198009755309046664501362808919434549263
    print(f"ct = {ct}")  # ct = 56274920108030879147510587900718628021081259042547196560477922498913815769467730659119705612390829987009186361032825981129859643199572873465457465957927246181


if __name__ == '__main__':
    main()
